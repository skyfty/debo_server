<admintpl file="header" />
</head>
<body>
<div class="wrap js-check-wrap">
    <ul class="nav nav-tabs">
        <li class="active"><a href="javascript:;">视频列表</a></li>

    </ul>
    <form class="well form-search" method="get" action="__CONTROLLER__/index">
        关键字：
        <input type="text" name="content" style="width: 200px;" value="{$formget.keyword|default=''}" placeholder="请输入用户id...">
        <input type="submit" class="btn btn-primary" value="搜索" />

        视频类型:
        <select name="type">
            <option value="">请选择</option>
            <volist name="resulta" id="v">
                <option value="{$v.state}"><if condition="$v.state eq 1">上传成功<elseif condition="$v.state eq 0" />上传失败</if></option>
            </volist>
        </select>
        <input value="查询" type="submit" />
    </form>
    <input type="checkbox" id="all" onclick="checked_opera()" value=""><span>全选</span>
    <input type="checkbox" id="reverse" value="" onclick="reverse_opera()"><span>反选</span>
    <input type="button" id="select_del" value="删除" style="width:50px;height:25px;font-size: 12px;display: inline-block;border: none;
    color: white;background-color:#1abc9c ;">
    <table class="table table-hover table-bordered table-list">
        <thead>
        <tr>
            <th></th>
            <th>ID</th>
            <th >发布用户</th>
            <th >视频标题</th>
            <th >视频描述</th>
            <th >视频ID</th>
            <th >视频展示</th>
            <th >视频状态</th>
            <th >发布时间</th>
            <th >操作</th>
        </tr>
        </thead>

        <foreach name="result" item="vo">
            <tr>
                <td><input type="checkbox" name="multi_select"><input type="hidden" value="{$vo.VideoId}" name="hidden_video_id"></td>
                <td>{$vo.id}</td>
                <td>{$vo.user_nickname}</td>
                <td>{$vo.Title}</td>
                <td>{$vo.Description}</td>
                <td>{$vo.VideoId}</td>
                <td style="width:50%;text-align: center;"><video controls="controls" poster="{$vo.CoverURL}" style="width:40%;height:20%">
                    <source src="{$vo.PlayURL}" type="video/mp4" />
                </video></td>
                <td>{$vo.Status}</td>
                <td>{$vo.CreateTime}</td>
                <td><a href="{:U('Video/delete',array('video_id'=>$vo['VideoId']))}">删除视频</a></td>
            </tr>
        </foreach>

    </table>
    <div class="pagination">{$page}</div>
    </form>
    <script src="./statics/js/common.js"></script>
    <script src="__PUBLIC__/js/jquery-1.10.2.min.js"></script>
</div>
</body>
</html>
<script type="text/javascript">
    function checked_opera(){
        var multi_select = document.getElementsByName('multi_select');
        var all = document.getElementById('all');
        var reverse = document.getElementById('reverse');
        for(var i=0;i<multi_select.length;i++){
            if(all.checked==true){
                reverse.checked=false;
                multi_select[i].checked=true;
            }else if(all.checked==false){
                multi_select[i].checked=false;
            }
        }
    }
    function reverse_opera(){
        var multi_select = document.getElementsByName('multi_select');
        var reverse = document.getElementById('reverse');
        var all = document.getElementById('all');
        if(reverse.checked==true){
            all.checked=false;
            for(var i=0;i<multi_select.length;i++){
                if(multi_select[i].checked==true){
                    multi_select[i].checked=false;
                }else{
                    multi_select[i].checked=true;
                }
            }
        }else{
            for(var i=0;i<multi_select.length;i++){
                if(multi_select[i].checked==true){
                    multi_select[i].checked=false;
                }else{
                    multi_select[i].checked=true;
                }
            }
        }

    }
//获取
//    var del_button = document.getElementsByName('del_button');
//    //alert(del_button.length)
//    for(var i=0;i<del_button.length;i++){
//        del_button.item(i).onclick=function(){
//
//        }
//    }


    var select_del = document.getElementById('select_del');
    select_del.onclick=function(){
        var multi_select = document.getElementsByName('multi_select');
        var hidden_video_id = document.getElementsByName('hidden_video_id');

        var video_ids = new Array();
        for(var i=0;i<multi_select.length;i++){
            if(multi_select[i].checked==true){
                video_ids[i] = hidden_video_id[i].value;
            }
        }

        if(video_ids.length == 0){
            alert('请选择要删除的对象');
            return;
        }

        var v_ids = video_ids.join(",");

        $.ajax({
            url:"__CONTROLLER__/delete",
            data:{"video_id":v_ids},
            type:'POST',
            success:function(data){
                location.reload();
            }
        });

    }

</script>